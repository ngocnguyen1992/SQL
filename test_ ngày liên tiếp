DECLARE @_i date, @_imax date, @_j date

SELECT @_i = MIN(Ngay_Ct) FROM dbo.BanHang -- = 1
SELECT @_imax = MAX(Ngay_Ct) FROM dbo.BanHang

WHILE @_i <= @_imax
BEGIN
SET @_i = DATEADD(MONTH,1,@_i) 
SELECT @_j = DATEADD(MONTH,1,@_i) 
	WHILE @_j <= @_imax
	BEGIN
		SET @_j = DATEADD(MONTH,1,@_j)
		IF(DATEDIFF(MONTH, @_i, @_j) = 1) 
		BEGIN
			UPDATE dbo.BanHang SET check_2 = 1
		END
		ELSE IF (DATEDIFF(MONTH, @_i, @_j) = 0) 
		BEGIN
			UPDATE dbo.BanHang SET check_2 = 0
		END
	END 
END

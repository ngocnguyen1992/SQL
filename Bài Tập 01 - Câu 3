-- Tìm mặt hàng bán chạy nhất trong khoảng thời gian từ ‘01/01/2013’ đến ‘31/01/2013’

DECLARE @_Ngay_BD DATE ='2013-01-01', 
		  @_Ngay_KT DATE ='2013-01-31'

SELECT TOP 1 WITH TIES bh.Ma_Vt, 
MAX(vt.Ten_Vt) AS Ten_Vt, 
SUM (bh.So_Luong) AS So_Luong
FROM dbo.DmVt vt, dbo.BanHang bh
WHERE vt.Ma_Vt = bh.Ma_Vt 
      AND Ngay_Ct >= @_Ngay_BD AND Ngay_Ct <= @_Ngay_KT
GROUP BY bh.Ma_Vt 
ORDER BY So_Luong DESC
